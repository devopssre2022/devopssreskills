pipeline{
    agent any
    
    tools {
        maven 'maven3.8.2'
    }
    
    triggers {
        pollSCM('* * * * *')
    }
    
    options {
    timestamps()   
    }    
    
    stages{
        
        stage('Checkout Code'){
            
            steps {
                git branch: 'development', credentialsId: 'git_credentials', url: 'https://github.com/tharun2109/maven-web-application.git'
            }
        }
        
        stage('Build'){
            
            steps {
                sh "mvn clean package"
            }
        }
        /*
        stage('ExecuteSonarQubeReport') {
            
            steps {
                sh "mvn clean sonar:sonar"
            }
        }
        
        stage('UploadArtifactToNexus') {
            
            steps {
                sh "mvn clean deploy"
            }
        }
        
        stage('DeployAppToTomcat') {
            steps {
                sshagent([''])
                sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@12.36.04.12:/opt/tomcat/webapps/"
            }
        }
        */
    }//stages closing
    
post{
    success{
        emailext to: 'tharun2954@gmail.com',
            subject: "Pipeline Build is over .. Build # is ..${env.BUILD_NUMBER} and Build status is.. ${currentBuild.result}.",
            body: "Pipeline Build is over .. Build # is ..${env.BUILD_NUMBER} and Build status is.. ${currentBuild.result}.",
            replyTo: 'tharun2954@gmail.com'
    }
 
    failure{
    emailext to: 'tharun2954@gmail.com',
            subject: "Pipeline Build is over .. Build # is ..${env.BUILD_NUMBER} and Build status is.. ${currentBuild.result}.",
            body: "Pipeline Build is over .. Build # is ..${env.BUILD_NUMBER} and Build status is.. ${currentBuild.result}.",
            replyTo: 'tharun2954@gmail.com'
    }
}
}
